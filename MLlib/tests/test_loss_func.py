from MLlib.loss_func import PoisonLoss
import numpy as np


def test_poisson_loss():
    X = np.array([[0.32794909, 0.69075792],
                  [0.9059869, 0.77822567],
                  [0.77191135, 0.73130334],
                  [0.78795424, 0.89521624],
                  [0.96298287, 0.29203895],
                  [0.17946441, 0.75993963],
                  [0.05451229, 0.85694996],
                  [0.2915702, 0.0805041],
                  [0.57499626, 0.10640506],
                  [0.95203463, 0.78138885],
                  [0.51214417, 0.8854669],
                  [0.94145457, 0.84719198]])
    Y = np.array([[0.78936729, 0.8704933, 0.88695031, 0.98672232, 0.29796081,
                   0.59689156, 0.88899604, 0.85520577, 0.18910425, 0.84729253,
                   0.53142304, 0.7346871]])
    W = np.array([[0.15736584],
                  [0.3036601]])

    poissonLoss = np.array([1.19509275])

    assert np.isclose(PoisonLoss.loss(X, Y, W), poissonLoss).all()
